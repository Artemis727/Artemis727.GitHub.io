<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Syaoran :)</title>
  
  
  <link href="https://artemis727.github.io/atom.xml" rel="self"/>
  
  <link href="https://artemis727.github.io/"/>
  <updated>2023-02-07T15:41:13.855Z</updated>
  <id>https://artemis727.github.io/</id>
  
  <author>
    <name>Syaoran Li</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Hello World</title>
    <link href="https://artemis727.github.io/2023/02/07/hello-world/"/>
    <id>https://artemis727.github.io/2023/02/07/hello-world/</id>
    <published>2023-02-07T15:41:13.854Z</published>
    <updated>2023-02-07T15:41:13.855Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a class="link"   href="https://hexo.io/" >Hexo<i class="fas fa-external-link-alt"></i></a>! This is your very first post. Check <a class="link"   href="https://hexo.io/docs/" >documentation<i class="fas fa-external-link-alt"></i></a> for more info. If you get any problems when using Hexo, you can find the answer in <a class="link"   href="https://hexo.io/docs/troubleshooting.html" >troubleshooting<i class="fas fa-external-link-alt"></i></a> or you can ask me on <a class="link"   href="https://github.com/hexojs/hexo/issues" >GitHub<i class="fas fa-external-link-alt"></i></a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a class="link"   href="https://hexo.io/docs/writing.html" >Writing<i class="fas fa-external-link-alt"></i></a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a class="link"   href="https://hexo.io/docs/server.html" >Server<i class="fas fa-external-link-alt"></i></a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a class="link"   href="https://hexo.io/docs/generating.html" >Generating<i class="fas fa-external-link-alt"></i></a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a class="link"   href="https://hexo.io/docs/one-command-deployment.html" >Deployment<i class="fas fa-external-link-alt"></i></a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome to &lt;a class=&quot;link&quot;   href=&quot;https://hexo.io/&quot; &gt;Hexo&lt;i class=&quot;fas fa-external-link-alt&quot;&gt;&lt;/i&gt;&lt;/a&gt;! This is your very first post. Che</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>SQL-åˆ·é¢˜ç¬”è®°</title>
    <link href="https://artemis727.github.io/2023/02/07/SQL%20%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    <id>https://artemis727.github.io/2023/02/07/SQL%20%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/</id>
    <published>2023-02-07T07:39:01.649Z</published>
    <updated>2023-02-08T02:19:44.228Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-æŸ¥è¯¢åˆ—"><a href="#1-æŸ¥è¯¢åˆ—" class="headerlink" title="1. æŸ¥è¯¢åˆ—"></a>1. æŸ¥è¯¢åˆ—</h1><p>åˆ—æŸ¥è¯¢ã€å¤šåˆ—æŸ¥è¯¢ã€é™åˆ¶è¿”å›æ•°é‡ã€inã€likeã€èšåˆå‡½æ•°ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥è¯¢æ‰€æœ‰åˆ—</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> user_profile</span><br><span class="line"></span><br><span class="line"># æŸ¥è¯¢å¤šåˆ—</span><br><span class="line"><span class="keyword">SELECT</span> device_id, gender, age, university <span class="keyword">FROM</span> user_profile</span><br><span class="line"></span><br><span class="line"># æŸ¥è¯¢ç»“æœå»é‡</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> university <span class="keyword">FROM</span> user_profile</span><br><span class="line"></span><br><span class="line"># æŸ¥è¯¢ç»“æœé™åˆ¶è¿”å›è¡Œæ•°</span><br><span class="line"><span class="keyword">SELECT</span> device_id <span class="keyword">FROM</span> user_profile LIMIT <span class="number">2</span></span><br><span class="line"></span><br><span class="line"># æŸ¥è¯¢åé‡å‘½å</span><br><span class="line"><span class="keyword">SELECT</span> device_id <span class="keyword">FROM</span> user_profile <span class="keyword">AS</span> user_infos_example LIMIT <span class="number">2</span></span><br><span class="line"></span><br><span class="line"># å¦å®šæŸ¥è¯¢</span><br><span class="line"><span class="keyword">select</span> device_id, gender, age, university</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">not</span> university <span class="operator">=</span> <span class="string">&#x27;å¤æ—¦å¤§å­¦&#x27;</span></span><br><span class="line"></span><br><span class="line"># è¿‡æ»¤ç©ºå€¼</span><br><span class="line"><span class="keyword">select</span> device_id, gender, age, university</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">not</span> age <span class="keyword">is</span> <span class="keyword">null</span></span><br><span class="line"></span><br><span class="line"># <span class="keyword">in</span></span><br><span class="line"><span class="keyword">select</span> device_id, gender, age, university, gpa </span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> university <span class="keyword">in</span> (<span class="string">&#x27;åŒ—äº¬å¤§å­¦&#x27;</span>, <span class="string">&#x27;å¤æ—¦å¤§å­¦&#x27;</span>, <span class="string">&#x27;å±±ä¸œå¤§å­¦&#x27;</span>)</span><br><span class="line"></span><br><span class="line"># <span class="keyword">like</span></span><br><span class="line"><span class="keyword">select</span> device_id, age, university</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> university <span class="keyword">like</span> <span class="string">&#x27;%åŒ—äº¬%&#x27;</span></span><br><span class="line"></span><br><span class="line"># <span class="built_in">max</span>() <span class="built_in">min</span>()</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(gpa)</span><br><span class="line"><span class="keyword">from</span> user_praofile</span><br><span class="line"><span class="keyword">where</span> university <span class="operator">=</span> <span class="string">&#x27;å¤æ—¦å¤§å­¦&#x27;</span></span><br><span class="line"></span><br><span class="line"># <span class="built_in">avg</span>() <span class="built_in">count</span>()</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(gender) <span class="keyword">as</span> male_num, <span class="built_in">avg</span>(gpa) <span class="keyword">as</span> avg_gpa</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> gender <span class="operator">=</span> <span class="string">&#x27;male&#x27;</span></span><br><span class="line"></span><br><span class="line"># <span class="keyword">having</span></span><br><span class="line"><span class="keyword">select</span> university, <span class="built_in">avg</span>(question_cnt) avg_question_cnt, <span class="built_in">avg</span>(answer_cnt) avg_answer_cnt</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> university</span><br><span class="line"><span class="keyword">having</span> avg_question_cnt <span class="operator">&lt;</span> <span class="number">5</span> <span class="keyword">or</span> avg_answer_cnt <span class="operator">&lt;</span> <span class="number">20</span></span><br><span class="line"># ç”Ÿæˆæ–°å­—æ®µåä¸èƒ½ç”¨<span class="keyword">where</span>è¦ç”¨<span class="keyword">having</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="2-æ¶‰åŠåˆ°å¤šä¸ªè¡¨çš„æƒ…å†µ"><a href="#2-æ¶‰åŠåˆ°å¤šä¸ªè¡¨çš„æƒ…å†µ" class="headerlink" title="2. æ¶‰åŠåˆ°å¤šä¸ªè¡¨çš„æƒ…å†µ"></a>2. æ¶‰åŠåˆ°å¤šä¸ªè¡¨çš„æƒ…å†µ</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> university, (<span class="built_in">count</span>(q.question_id)<span class="operator">/</span><span class="built_in">count</span>(<span class="keyword">distinct</span>(q.device_id))) avg_answer_cnt</span><br><span class="line"><span class="keyword">from</span> user_profile u</span><br><span class="line"><span class="keyword">join</span> question_practice_detail q</span><br><span class="line"><span class="keyword">on</span> u.device_id <span class="operator">=</span> q.device_id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> university</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> university <span class="keyword">asc</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> u.university, q.difficult_level, <span class="built_in">count</span>(qp.question_id)<span class="operator">/</span><span class="built_in">count</span>(<span class="keyword">distinct</span> qp.device_id) avg_answer_cnt</span><br><span class="line"><span class="keyword">from</span> user_profile u, question_practice_detail qp, question_detail q</span><br><span class="line"><span class="keyword">where</span> u.university <span class="operator">=</span> <span class="string">&#x27;å±±ä¸œå¤§å­¦&#x27;</span> <span class="keyword">and</span> u.device_id <span class="operator">=</span> qp.device_id <span class="keyword">and</span> q.question_id <span class="operator">=</span> qp.question_id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> u.university, difficult_level</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> avg_answer_cnt</span><br></pre></td></tr></table></figure><h2 id="SQL25-æŸ¥æ‰¾å±±ä¸œå¤§å­¦æˆ–è€…æ€§åˆ«ä¸ºç”·ç”Ÿçš„ä¿¡æ¯"><a href="#SQL25-æŸ¥æ‰¾å±±ä¸œå¤§å­¦æˆ–è€…æ€§åˆ«ä¸ºç”·ç”Ÿçš„ä¿¡æ¯" class="headerlink" title="SQL25 æŸ¥æ‰¾å±±ä¸œå¤§å­¦æˆ–è€…æ€§åˆ«ä¸ºç”·ç”Ÿçš„ä¿¡æ¯"></a><strong>SQL25</strong> æŸ¥æ‰¾å±±ä¸œå¤§å­¦æˆ–è€…æ€§åˆ«ä¸ºç”·ç”Ÿçš„ä¿¡æ¯</h2><p>é¢˜ç›®ï¼šç°åœ¨è¿è¥æƒ³è¦åˆ†åˆ«æŸ¥çœ‹å­¦æ ¡ä¸ºå±±ä¸œå¤§å­¦æˆ–è€…æ€§åˆ«ä¸ºç”·æ€§çš„ç”¨æˆ·çš„device_idã€genderã€ageå’Œgpaæ•°æ®ï¼Œè¯·å–å‡ºç›¸åº”ç»“æœï¼Œç»“æœä¸å»é‡ã€‚</p><p>ç¤ºä¾‹ï¼šuser_profile</p><table><thead><tr><th>id</th><th>device_id</th><th>gender</th><th>age</th><th>university</th><th>gpa</th><th>active_days_within_30</th><th>question_cnt</th><th>answer_cnt</th></tr></thead><tbody><tr><td>1</td><td>2138</td><td>male</td><td>21</td><td>åŒ—äº¬å¤§å­¦</td><td>3.4</td><td>7</td><td>2</td><td>12</td></tr><tr><td>2</td><td>3214</td><td>male</td><td></td><td>å¤æ—¦å¤§å­¦</td><td>4</td><td>15</td><td>5</td><td>25</td></tr><tr><td>3</td><td>6543</td><td>female</td><td>20</td><td>åŒ—äº¬å¤§å­¦</td><td>3.2</td><td>12</td><td>3</td><td>30</td></tr><tr><td>4</td><td>2315</td><td>female</td><td>23</td><td>æµ™æ±Ÿå¤§å­¦</td><td>3.6</td><td>5</td><td>1</td><td>2</td></tr><tr><td>5</td><td>5432</td><td>male</td><td>25</td><td>å±±ä¸œå¤§å­¦</td><td>3.8</td><td>20</td><td>15</td><td>70</td></tr><tr><td>6</td><td>2131</td><td>male</td><td>28</td><td>å±±ä¸œå¤§å­¦</td><td>3.3</td><td>15</td><td>7</td><td>13</td></tr><tr><td>7</td><td>4321</td><td>male</td><td>26</td><td>å¤æ—¦å¤§å­¦</td><td>3.6</td><td>9</td><td>6</td><td>52</td></tr></tbody></table><p>æ ¹æ®ç¤ºä¾‹ï¼Œä½ çš„æŸ¥è¯¢åº”è¿”å›ä»¥ä¸‹ç»“æœï¼ˆæ³¨æ„è¾“å‡ºçš„é¡ºåºï¼Œå…ˆè¾“å‡ºå­¦æ ¡ä¸ºå±±ä¸œå¤§å­¦å†è¾“å‡ºæ€§åˆ«ä¸ºç”·ç”Ÿçš„ä¿¡æ¯ï¼‰ï¼š</p><table><thead><tr><th>device_id</th><th>gender</th><th>age</th><th>gpa</th></tr></thead><tbody><tr><td>5432</td><td>male</td><td>25</td><td>3.8</td></tr><tr><td>2131</td><td>male</td><td>28</td><td>3.3</td></tr><tr><td>2138</td><td>male</td><td>21</td><td>3.4</td></tr><tr><td>3214</td><td>male</td><td>None</td><td>4</td></tr><tr><td>5432</td><td>male</td><td>25</td><td>3.8</td></tr><tr><td>2131</td><td>male</td><td>28</td><td>3.3</td></tr><tr><td>4321</td><td>male</td><td>28</td><td>3.6</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> device_id, gender, age, gpa</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> university <span class="operator">=</span> <span class="string">&#x27;å±±ä¸œå¤§å­¦&#x27;</span></span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span> </span><br><span class="line"><span class="keyword">select</span> device_id, gender, age, gpa</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> gender <span class="operator">=</span> <span class="string">&#x27;male&#x27;</span></span><br></pre></td></tr></table></figure><h1 id="3-if"><a href="#3-if" class="headerlink" title="3. if"></a>3. if</h1><h2 id="SQL26-è®¡ç®—25å²ä»¥ä¸Šå’Œä»¥ä¸‹çš„ç”¨æˆ·æ•°é‡"><a href="#SQL26-è®¡ç®—25å²ä»¥ä¸Šå’Œä»¥ä¸‹çš„ç”¨æˆ·æ•°é‡" class="headerlink" title="SQL26 è®¡ç®—25å²ä»¥ä¸Šå’Œä»¥ä¸‹çš„ç”¨æˆ·æ•°é‡"></a>SQL26 <strong>è®¡ç®—25å²ä»¥ä¸Šå’Œä»¥ä¸‹çš„ç”¨æˆ·æ•°é‡</strong></h2><p>é¢˜ç›®ï¼šç°åœ¨è¿è¥æƒ³è¦å°†ç”¨æˆ·åˆ’åˆ†ä¸º25å²ä»¥ä¸‹å’Œ25å²åŠä»¥ä¸Šä¸¤ä¸ªå¹´é¾„æ®µï¼Œåˆ†åˆ«æŸ¥çœ‹è¿™ä¸¤ä¸ªå¹´é¾„æ®µç”¨æˆ·æ•°é‡</p><p><strong>æœ¬é¢˜æ³¨æ„ï¼šageä¸ºnull ä¹Ÿè®°ä¸º 25å²ä»¥ä¸‹</strong></p><p>ç¤ºä¾‹ï¼šuser_profile</p><table><thead><tr><th>id</th><th>device_id</th><th>gender</th><th>age</th><th>university</th><th>gpa</th><th>active_days_within_30</th><th>question_cnt</th><th>answer_cnt</th></tr></thead><tbody><tr><td>1</td><td>2138</td><td>male</td><td>21</td><td>åŒ—äº¬å¤§å­¦</td><td>3.4</td><td>7</td><td>2</td><td>12</td></tr><tr><td>2</td><td>3214</td><td>male</td><td></td><td>å¤æ—¦å¤§å­¦</td><td>4</td><td>15</td><td>5</td><td>25</td></tr><tr><td>3</td><td>6543</td><td>female</td><td>20</td><td>åŒ—äº¬å¤§å­¦</td><td>3.2</td><td>12</td><td>3</td><td>30</td></tr><tr><td>4</td><td>2315</td><td>female</td><td>23</td><td>æµ™æ±Ÿå¤§å­¦</td><td>3.6</td><td>5</td><td>1</td><td>2</td></tr><tr><td>5</td><td>5432</td><td>male</td><td>25</td><td>å±±ä¸œå¤§å­¦</td><td>3.8</td><td>20</td><td>15</td><td>70</td></tr><tr><td>6</td><td>2131</td><td>male</td><td>28</td><td>å±±ä¸œå¤§å­¦</td><td>3.3</td><td>15</td><td>7</td><td>13</td></tr><tr><td>7</td><td>4321</td><td>male</td><td>26</td><td>å¤æ—¦å¤§å­¦</td><td>3.6</td><td>9</td><td>6</td><td>52</td></tr></tbody></table><p>æ ¹æ®ç¤ºä¾‹ï¼Œä½ çš„æŸ¥è¯¢åº”è¿”å›ä»¥ä¸‹ç»“æœï¼š</p><table><thead><tr><th>age_cut</th><th>number</th></tr></thead><tbody><tr><td>25å²ä»¥ä¸‹</td><td>4</td></tr><tr><td>25å²åŠä»¥ä¸Š</td><td>3</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> age_cut, <span class="built_in">count</span>(device_id) number</span><br><span class="line"><span class="keyword">from</span>(<span class="keyword">select</span> if(age <span class="operator">&gt;=</span> <span class="number">25</span>, <span class="string">&#x27;25å²åŠä»¥ä¸Š&#x27;</span>, <span class="string">&#x27;25å²ä»¥ä¸‹&#x27;</span>) <span class="keyword">as</span> age_cut, device_id <span class="keyword">from</span> user_profile) t1</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> age_cut</span><br></pre></td></tr></table></figure><h1 id="4-case"><a href="#4-case" class="headerlink" title="4. case"></a>4. case</h1><h2 id="SQL27-æŸ¥çœ‹ä¸åŒå¹´é¾„æ®µçš„ç”¨æˆ·æ˜ç»†"><a href="#SQL27-æŸ¥çœ‹ä¸åŒå¹´é¾„æ®µçš„ç”¨æˆ·æ˜ç»†" class="headerlink" title="SQL27 æŸ¥çœ‹ä¸åŒå¹´é¾„æ®µçš„ç”¨æˆ·æ˜ç»†"></a><strong>SQL27</strong> <strong>æŸ¥çœ‹ä¸åŒå¹´é¾„æ®µçš„ç”¨æˆ·æ˜ç»†</strong></h2><p>é¢˜ç›®ï¼šç°åœ¨è¿è¥æƒ³è¦å°†ç”¨æˆ·åˆ’åˆ†ä¸º<strong>20å²ä»¥ä¸‹ï¼Œ20-24å²ï¼Œ25å²åŠä»¥ä¸Š</strong>ä¸‰ä¸ªå¹´é¾„æ®µï¼Œåˆ†åˆ«æŸ¥çœ‹ä¸åŒå¹´é¾„æ®µç”¨æˆ·çš„æ˜ç»†æƒ…å†µï¼Œè¯·å–å‡ºç›¸åº”æ•°æ®ã€‚ï¼ˆæ³¨ï¼šè‹¥<strong>å¹´é¾„ä¸ºç©º</strong>è¯·è¿”å›<strong>å…¶ä»–</strong>ã€‚ï¼‰</p><p>ç¤ºä¾‹ï¼šuser_profile</p><table><thead><tr><th>id</th><th>device_id</th><th>gender</th><th>age</th><th>university</th><th>gpa</th><th>active_days_within_30</th><th>question_cnt</th><th>answer_cnt</th></tr></thead><tbody><tr><td>1</td><td>2138</td><td>male</td><td>21</td><td>åŒ—äº¬å¤§å­¦</td><td>3.4</td><td>7</td><td>2</td><td>12</td></tr><tr><td>2</td><td>3214</td><td>male</td><td></td><td>å¤æ—¦å¤§å­¦</td><td>4</td><td>15</td><td>5</td><td>25</td></tr><tr><td>3</td><td>6543</td><td>female</td><td>20</td><td>åŒ—äº¬å¤§å­¦</td><td>3.2</td><td>12</td><td>3</td><td>30</td></tr><tr><td>4</td><td>2315</td><td>female</td><td>23</td><td>æµ™æ±Ÿå¤§å­¦</td><td>3.6</td><td>5</td><td>1</td><td>2</td></tr><tr><td>5</td><td>5432</td><td>male</td><td>25</td><td>å±±ä¸œå¤§å­¦</td><td>3.8</td><td>20</td><td>15</td><td>70</td></tr><tr><td>6</td><td>2131</td><td>male</td><td>28</td><td>å±±ä¸œå¤§å­¦</td><td>3.3</td><td>15</td><td>7</td><td>13</td></tr><tr><td>7</td><td>4321</td><td>male</td><td>26</td><td>å¤æ—¦å¤§å­¦</td><td>3.6</td><td>9</td><td>6</td><td>52</td></tr></tbody></table><p>æ ¹æ®ç¤ºä¾‹ï¼Œä½ çš„æŸ¥è¯¢åº”è¿”å›ä»¥ä¸‹ç»“æœï¼š</p><table><thead><tr><th>device_id</th><th>gender</th><th>age_cut</th></tr></thead><tbody><tr><td>2138</td><td>male</td><td>20-24å²</td></tr><tr><td>3214</td><td>male</td><td>å…¶ä»–</td></tr><tr><td>6543</td><td>female</td><td>20-24å²</td></tr><tr><td>2315</td><td>female</td><td>20-24å²</td></tr><tr><td>5432</td><td>male</td><td>25å²åŠä»¥ä¸Š</td></tr><tr><td>2131</td><td>male</td><td>25å²åŠä»¥ä¸Š</td></tr><tr><td>4321</td><td>male</td><td>25å²åŠä»¥ä¸Š</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> device_id, gender, </span><br><span class="line"><span class="keyword">case</span></span><br><span class="line">    <span class="keyword">when</span> age <span class="operator">&lt;</span> <span class="number">20</span> <span class="keyword">then</span> <span class="string">&#x27;20å²ä»¥ä¸‹&#x27;</span></span><br><span class="line">    <span class="keyword">when</span> age <span class="operator">&lt;</span> <span class="number">25</span> <span class="keyword">then</span> <span class="string">&#x27;20-24å²&#x27;</span></span><br><span class="line">    <span class="keyword">when</span> age <span class="operator">&gt;=</span> <span class="number">25</span> <span class="keyword">then</span> <span class="string">&#x27;25å²åŠä»¥ä¸Š&#x27;</span></span><br><span class="line">    <span class="keyword">else</span> <span class="string">&#x27;å…¶ä»–&#x27;</span></span><br><span class="line"><span class="keyword">end</span> age_cut</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br></pre></td></tr></table></figure><h1 id="5-day"><a href="#5-day" class="headerlink" title="5. day()"></a>5. day()</h1><ul><li><p>day()</p></li><li><p>month()</p></li><li><p>year()</p></li></ul><h1 id="6-ç”¨æˆ·ç•™å­˜ç‡è®¡ç®—"><a href="#6-ç”¨æˆ·ç•™å­˜ç‡è®¡ç®—" class="headerlink" title="6. ç”¨æˆ·ç•™å­˜ç‡è®¡ç®—"></a>6. ç”¨æˆ·ç•™å­˜ç‡è®¡ç®—</h1><p><a href="/Users/xiaoyu/Documents/%E5%8D%9A%E5%AE%A2/SQL-%E8%AE%A1%E7%AE%97%E7%94%A8%E6%88%B7%E6%AC%A1%E6%97%A5%E7%95%99%E5%AD%98%E7%8E%87.md">SQL-è®¡ç®—ç”¨æˆ·æ¬¡æ—¥ç•™å­˜ç‡.md</a></p><h1 id="7-å­—ç¬¦ä¸²ç›¸å…³"><a href="#7-å­—ç¬¦ä¸²ç›¸å…³" class="headerlink" title="7. å­—ç¬¦ä¸²ç›¸å…³"></a>7. å­—ç¬¦ä¸²ç›¸å…³</h1><p><a href="/Users/xiaoyu/Documents/%E5%8D%9A%E5%AE%A2/SQL-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9B%B8%E5%85%B3.md">SQL-å­—ç¬¦ä¸²ç›¸å…³.md</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-æŸ¥è¯¢åˆ—&quot;&gt;&lt;a href=&quot;#1-æŸ¥è¯¢åˆ—&quot; class=&quot;headerlink&quot; title=&quot;1. æŸ¥è¯¢åˆ—&quot;&gt;&lt;/a&gt;1. æŸ¥è¯¢åˆ—&lt;/h1&gt;&lt;p&gt;åˆ—æŸ¥è¯¢ã€å¤šåˆ—æŸ¥è¯¢ã€é™åˆ¶è¿”å›æ•°é‡ã€inã€likeã€èšåˆå‡½æ•°ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlig</summary>
      
    
    
    
    <category term="Programming" scheme="https://artemis727.github.io/categories/Programming/"/>
    
    <category term="SQL" scheme="https://artemis727.github.io/categories/Programming/SQL/"/>
    
    
    <category term="SQL" scheme="https://artemis727.github.io/tags/SQL/"/>
    
    <category term="åˆ·é¢˜ç¬”è®°" scheme="https://artemis727.github.io/tags/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>SQL-å­—ç¬¦ä¸²ç›¸å…³</title>
    <link href="https://artemis727.github.io/2023/02/07/SQL-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9B%B8%E5%85%B3/"/>
    <id>https://artemis727.github.io/2023/02/07/SQL-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9B%B8%E5%85%B3/</id>
    <published>2023-02-07T04:47:41.452Z</published>
    <updated>2023-02-08T01:49:29.899Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SQL30-ç»Ÿè®¡æ¯ç§æ€§åˆ«çš„äººæ•°"><a href="#SQL30-ç»Ÿè®¡æ¯ç§æ€§åˆ«çš„äººæ•°" class="headerlink" title="SQL30 ç»Ÿè®¡æ¯ç§æ€§åˆ«çš„äººæ•°"></a><strong>SQL30</strong> <strong>ç»Ÿè®¡æ¯ç§æ€§åˆ«çš„äººæ•°</strong></h1><h2 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h2><p>é¢˜ç›®ï¼šç°åœ¨è¿è¥ä¸¾åŠäº†ä¸€åœºæ¯”èµ›ï¼Œæ”¶åˆ°äº†ä¸€äº›å‚èµ›ç”³è¯·ï¼Œè¡¨æ•°æ®è®°å½•å½¢å¼å¦‚ä¸‹æ‰€ç¤ºï¼Œç°åœ¨è¿è¥æƒ³è¦ç»Ÿè®¡æ¯ä¸ªæ€§åˆ«çš„ç”¨æˆ·åˆ†åˆ«æœ‰å¤šå°‘å‚èµ›è€…ï¼Œè¯·å–å‡ºç›¸åº”ç»“æœ</p><p>ç¤ºä¾‹ï¼šuser_submit</p><table><thead><tr><th>device_id</th><th>profile</th><th>blog_url</th></tr></thead><tbody><tr><td>2138</td><td>180cm,75kg,27,male</td><td>http:&#x2F;url&#x2F;bigboy777</td></tr><tr><td>3214</td><td>165cm,45kg,26,female</td><td>http:&#x2F;url&#x2F;kittycc</td></tr><tr><td>6543</td><td>178cm,65kg,25,male</td><td>http:&#x2F;url&#x2F;tiger</td></tr><tr><td>4321</td><td>171cm,55kg,23,female</td><td>http:&#x2F;url&#x2F;uhksd</td></tr><tr><td>2131</td><td>168cm,45kg,22,female</td><td>http:&#x2F;urlsydney</td></tr></tbody></table><p>æ ¹æ®ç¤ºä¾‹ï¼Œä½ çš„æŸ¥è¯¢åº”è¿”å›ä»¥ä¸‹ç»“æœï¼š</p><table><thead><tr><th>gender</th><th>number</th></tr></thead><tbody><tr><td>male</td><td>2</td></tr><tr><td>female</td><td>3</td></tr></tbody></table><hr><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> substring_index(profile, <span class="string">&#x27;,&#x27;</span>, <span class="number">-1</span>) <span class="keyword">as</span> gender, <span class="built_in">count</span>(device_id)</span><br><span class="line"><span class="keyword">from</span> user_submit</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> gender</span><br></pre></td></tr></table></figure><h1 id="SQL31-æå–åšå®¢URLä¸­çš„ç”¨æˆ·å"><a href="#SQL31-æå–åšå®¢URLä¸­çš„ç”¨æˆ·å" class="headerlink" title="SQL31 æå–åšå®¢URLä¸­çš„ç”¨æˆ·å"></a><strong>SQL31</strong> <strong>æå–åšå®¢URLä¸­çš„ç”¨æˆ·å</strong></h1><h2 id="æè¿°-1"><a href="#æè¿°-1" class="headerlink" title="æè¿°"></a>æè¿°</h2><p>é¢˜ç›®ï¼šå¯¹äºç”³è¯·å‚ä¸æ¯”èµ›çš„ç”¨æˆ·ï¼Œblog_urlå­—æ®µä¸­urlå­—ç¬¦åçš„å­—ç¬¦ä¸²ä¸ºç”¨æˆ·ä¸ªäººåšå®¢çš„ç”¨æˆ·åï¼Œç°åœ¨è¿è¥æƒ³è¦æŠŠç”¨æˆ·çš„ä¸ªäººåšå®¢ç”¨æˆ·å­—æ®µæå–å‡ºå•ç‹¬è®°å½•ä¸ºä¸€ä¸ªæ–°çš„å­—æ®µï¼Œè¯·å–å‡ºæ‰€éœ€æ•°æ®ã€‚</p><p>ç¤ºä¾‹ï¼šuser_submit</p><table><thead><tr><th>device_id</th><th>profile</th><th>blog_url</th></tr></thead><tbody><tr><td>2138</td><td>180cm,75kg,27,male</td><td>http:&#x2F;ur&#x2F;bisdgboy777</td></tr><tr><td>3214</td><td>165cm,45kg,26,female</td><td>http:&#x2F;url&#x2F;dkittycc</td></tr><tr><td>6543</td><td>178cm,65kg,25,male</td><td>http:&#x2F;ur&#x2F;tigaer</td></tr><tr><td>4321</td><td>171 cm,55kg,23,female</td><td>http:&#x2F;url&#x2F;uhksd</td></tr><tr><td>2131</td><td>168cm,45kg,22,female</td><td>http:&#x2F;url&#x2F;sydney</td></tr></tbody></table><p>æ ¹æ®ç¤ºä¾‹ï¼Œä½ çš„æŸ¥è¯¢åº”è¿”å›ä»¥ä¸‹ç»“æœï¼š</p><table><thead><tr><th>device_id</th><th>user_name</th></tr></thead><tbody><tr><td>2138</td><td>bisdgboy777</td></tr><tr><td>3214</td><td>dkittycc</td></tr><tr><td>6543</td><td>tigaer</td></tr><tr><td>4321</td><td>uhsksd</td></tr><tr><td>2131</td><td>sydney</td></tr></tbody></table><hr><h3 id="æå–æŸä¸ªå­—ç¬¦ä¸€èˆ¬æœ‰å››ç§åšæ³•ï¼š"><a href="#æå–æŸä¸ªå­—ç¬¦ä¸€èˆ¬æœ‰å››ç§åšæ³•ï¼š" class="headerlink" title="æå–æŸä¸ªå­—ç¬¦ä¸€èˆ¬æœ‰å››ç§åšæ³•ï¼š"></a>æå–æŸä¸ªå­—ç¬¦ä¸€èˆ¬æœ‰å››ç§åšæ³•ï¼š</h3><ol><li><p><strong>trim()</strong></p><p>trim() æ˜¯ç›´æ¥æ›´æ”¹ç›¸åŒæ ¼å¼çš„ä¸€åˆ—ï¼Œåˆ é™¤è¿™ä¸€åˆ—å†…å®¹ä¸­çš„ç»Ÿä¸€éƒ¨åˆ†ï¼Œç„¶åé‡å‘½åï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> device_id, <span class="built_in">trim</span>(<span class="string">&#x27;http:/url/&#x27;</span> <span class="keyword">from</span> blog_url) <span class="keyword">as</span> user_name</span><br><span class="line"><span class="keyword">from</span> user_submit</span><br></pre></td></tr></table></figure><p>â€‹</p></li><li><p><strong>substring_index()</strong></p><p>substring_index() æ˜¯å°†å­—ç¬¦ä¸²åˆ‡å‰²ï¼Œ1è¡¨ç¤ºä¿ç•™å­—ç¬¦ä¸²çš„å·¦è¾¹ğŸ‘ˆï¼Œ-1è¡¨ç¤ºä¿ç•™å­—ç¬¦ä¸²çš„å³è¾¹ğŸ‘‰ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> device_id, substring_index(blog_url, <span class="string">&#x27;/url/&#x27;</span>, <span class="number">-1</span>) <span class="keyword">as</span> user_name</span><br><span class="line"><span class="keyword">from</span> user_submit</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ä¸ªç”¨æ³•æ˜¯è®¡æ•°ï¼š</p><p>SUBSTRING_INDEX(str,delim,count) è¿”å›ä»å­—ç¬¦ä¸²stråˆ†éš”ç¬¦ delim åœ¨è®¡æ•°å‘ç”Ÿå‰çš„å­å­—ç¬¦ä¸²ã€‚å¦‚æœè®¡æ•°æ˜¯æ­£çš„ï¼Œåˆ™è¿”å›ä¸€åˆ‡åˆ°æœ€ç»ˆå®šç•Œç¬¦(ä»å·¦è¾¹ç®—èµ·)çš„å·¦ä¾§ã€‚å¦‚æœcountæ˜¯è´Ÿæ•°ï¼Œåˆ™è¿”å›ä¸€åˆ‡æœ€ç»ˆå®šç•Œç¬¦(ä»å³è¾¹ç®—èµ·)çš„å³ä¾§ã€‚SUBSTRING_INDEX() æœå¯»åœ¨delimæ—¶è¿›è¡ŒåŒºåˆ†å¤§å°å†™çš„åŒ¹é…ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> SUBSTRING_INDEX(<span class="string">&#x27;www.somewebsite.com&#x27;</span>,<span class="string">&#x27;.&#x27;</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure><p>Output: <code>&#39;www.somewebsite&#39;</code></p></li><li><p><strong>substr()</strong></p><p>substr() æ˜¯ç”¨å…·ä½“ä½ç½®ï¼ˆæ•°å­—ï¼‰æ¥è¡¨ç¤ºä»å“ªå¼€å§‹æˆªå–çš„ï¼Œå‚æ•°é‡Œè¿˜åŒ…æ‹¬æˆªå–çš„é•¿åº¦ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> device_id, substr(blog_url, <span class="number">11</span>, length(blog_url)<span class="number">-10</span>) <span class="keyword">as</span> user_name</span><br><span class="line"><span class="keyword">from</span> user_submit</span><br></pre></td></tr></table></figure></li><li><p><strong>replace()</strong></p><p>replace() å°±æ˜¯æ›¿æ¢å‡½æ•°ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sleect device_id, replace(blog_url, <span class="string">&#x27;http:/url/&#x27;</span>, <span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> user_name</span><br><span class="line"><span class="keyword">from</span> user_submit</span><br></pre></td></tr></table></figure></li></ol><h1 id="SQL32-æˆªå–å‡ºå¹´é¾„"><a href="#SQL32-æˆªå–å‡ºå¹´é¾„" class="headerlink" title="SQL32 æˆªå–å‡ºå¹´é¾„"></a><strong>SQL32</strong> <strong>æˆªå–å‡ºå¹´é¾„</strong></h1><h2 id="æè¿°-2"><a href="#æè¿°-2" class="headerlink" title="æè¿°"></a>æè¿°</h2><p>é¢˜ç›®ï¼šç°åœ¨è¿è¥ä¸¾åŠäº†ä¸€åœºæ¯”èµ›ï¼Œæ”¶åˆ°äº†ä¸€äº›å‚èµ›ç”³è¯·ï¼Œè¡¨æ•°æ®è®°å½•å½¢å¼å¦‚ä¸‹æ‰€ç¤ºï¼Œç°åœ¨è¿è¥æƒ³è¦ç»Ÿè®¡æ¯ä¸ªå¹´é¾„çš„ç”¨æˆ·åˆ†åˆ«æœ‰å¤šå°‘å‚èµ›è€…ï¼Œè¯·å–å‡ºç›¸åº”ç»“æœ</p><p>ç¤ºä¾‹ï¼šuser_submit</p><table><thead><tr><th>device_id</th><th>profile</th><th>blog_url</th></tr></thead><tbody><tr><td>2138</td><td>180cm,75kg,27,male</td><td>http:&#x2F;ur&#x2F;bigboy777</td></tr><tr><td>3214</td><td>165cm,45kg,26,female</td><td>http:&#x2F;url&#x2F;kittycc</td></tr><tr><td>6543</td><td>178cm,65kg,25,male</td><td>http:&#x2F;url&#x2F;tiger</td></tr><tr><td>4321</td><td>171cm,55kg,23,female</td><td>http:&#x2F;url&#x2F;uhksd</td></tr><tr><td>2131</td><td>168cm,45kg,22,female</td><td>http:&#x2F;url&#x2F;sydney</td></tr></tbody></table><p>æ ¹æ®ç¤ºä¾‹ï¼Œä½ çš„æŸ¥è¯¢åº”è¿”å›ä»¥ä¸‹ç»“æœï¼š</p><table><thead><tr><th>age</th><th>number</th></tr></thead><tbody><tr><td>27</td><td>1</td></tr><tr><td>26</td><td>1</td></tr><tr><td>25</td><td>1</td></tr><tr><td>23</td><td>1</td></tr><tr><td>22</td><td>1</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> substring_index(substring_index(profile, <span class="string">&#x27;,&#x27;</span>, <span class="number">-2</span>), <span class="string">&#x27;,&#x27;</span>, <span class="number">1</span>) <span class="keyword">as</span> age, <span class="built_in">count</span>(device_id)</span><br><span class="line"><span class="keyword">from</span> user_submit</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> age</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;SQL30-ç»Ÿè®¡æ¯ç§æ€§åˆ«çš„äººæ•°&quot;&gt;&lt;a href=&quot;#SQL30-ç»Ÿè®¡æ¯ç§æ€§åˆ«çš„äººæ•°&quot; class=&quot;headerlink&quot; title=&quot;SQL30 ç»Ÿè®¡æ¯ç§æ€§åˆ«çš„äººæ•°&quot;&gt;&lt;/a&gt;&lt;strong&gt;SQL30&lt;/strong&gt; &lt;strong&gt;ç»Ÿè®¡æ¯ç§æ€§åˆ«çš„äººæ•°&lt;</summary>
      
    
    
    
    <category term="Programming" scheme="https://artemis727.github.io/categories/Programming/"/>
    
    <category term="SQL" scheme="https://artemis727.github.io/categories/Programming/SQL/"/>
    
    
    <category term="SQL" scheme="https://artemis727.github.io/tags/SQL/"/>
    
    <category term="å­—ç¬¦ä¸²" scheme="https://artemis727.github.io/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    
  </entry>
  
  <entry>
    <title>SQL-è®¡ç®—ç”¨æˆ·ç•™å­˜ç‡</title>
    <link href="https://artemis727.github.io/2023/02/07/SQL-%E8%AE%A1%E7%AE%97%E7%94%A8%E6%88%B7%E6%AC%A1%E6%97%A5%E7%95%99%E5%AD%98%E7%8E%87/"/>
    <id>https://artemis727.github.io/2023/02/07/SQL-%E8%AE%A1%E7%AE%97%E7%94%A8%E6%88%B7%E6%AC%A1%E6%97%A5%E7%95%99%E5%AD%98%E7%8E%87/</id>
    <published>2023-02-07T02:17:12.143Z</published>
    <updated>2023-02-08T01:49:32.429Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è®¡ç®—ç”¨æˆ·æ¬¡æ—¥ç•™å­˜ç‡"><a href="#è®¡ç®—ç”¨æˆ·æ¬¡æ—¥ç•™å­˜ç‡" class="headerlink" title="è®¡ç®—ç”¨æˆ·æ¬¡æ—¥ç•™å­˜ç‡"></a>è®¡ç®—ç”¨æˆ·æ¬¡æ—¥ç•™å­˜ç‡</h1><p>å¦‚æœåªæ˜¯è®¡ç®—ç”¨æˆ·çš„<strong>æ¬¡æ—¥</strong>ç•™å­˜ç‡ï¼Œé‚£ä¹ˆä½¿ç”¨date_sub()å‡½æ•°å°±å¤Ÿäº†ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(if(b.device_id <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>, <span class="number">1</span>, <span class="number">0</span>)) <span class="keyword">as</span> avg_ret</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">distinct</span> device_id, <span class="type">date</span></span><br><span class="line">    <span class="keyword">from</span> question_practice_detail</span><br><span class="line">) a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span>(</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">distinct</span> device_id, date_sub(<span class="type">date</span>, <span class="type">interval</span> <span class="number">1</span> <span class="keyword">day</span>) <span class="keyword">as</span> <span class="type">date</span></span><br><span class="line">    <span class="keyword">from</span> question_practice_detail</span><br><span class="line">) b</span><br><span class="line"><span class="keyword">on</span> a.device_id <span class="operator">=</span> b.device_id <span class="keyword">and</span> a.date <span class="operator">=</span> b.date</span><br></pre></td></tr></table></figure><ul><li><p><strong>date_sub() å‡½æ•°ï¼š</strong></p><ul><li><p>SELECT DATE_SUB(â€˜2010-08-12â€™, INTERVAL 3 DAY) AS NewDate </p><p>ç»“æœï¼š 2010-08-09</p></li><li><p>SELECT DATE_SUB(â€˜2010-08-12â€™, INTERVAL â€˜3-2â€™ YEAR_MONTH) AS NewDate </p><p>ç»“æœï¼š 2007-06-12</p></li><li><p>SELECT DATE_SUB(â€˜2011-09-14 2:44:36â€™, INTERVAL â€˜2:26â€™ HOUR_MINUTE) AS NewDate </p><p>ç»“æœï¼š 2011-09-14 00:18:36</p></li></ul></li></ul><h1 id="åŸºäºSQLçš„ç•™å­˜ç‡è®¡ç®—"><a href="#åŸºäºSQLçš„ç•™å­˜ç‡è®¡ç®—" class="headerlink" title="åŸºäºSQLçš„ç•™å­˜ç‡è®¡ç®—"></a>åŸºäºSQLçš„ç•™å­˜ç‡è®¡ç®—</h1><blockquote><p>è½¬è‡ª<a class="link"   href="https://zhuanlan.zhihu.com/p/178598910" >çŸ¥ä¹ï¼šåŸºäºSQLçš„ç•™å­˜ç‡è®¡ç®—<i class="fas fa-external-link-alt"></i></a></p></blockquote><h2 id="ä¸€ã€ä»€ä¹ˆæ˜¯ç•™å­˜ç‡"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯ç•™å­˜ç‡" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯ç•™å­˜ç‡"></a>ä¸€ã€ä»€ä¹ˆæ˜¯ç•™å­˜ç‡</h2><p>äº’è”ç½‘è¡Œä¸šé‡Œï¼Œç•™å­˜ç‡æ˜¯ç”¨äºåæ˜ ç½‘ç«™ã€äº’è”ç½‘åº”ç”¨æˆ–ç½‘ç»œæ¸¸æˆçš„<strong>è¿è¥æƒ…å†µ</strong>çš„ç»Ÿè®¡æŒ‡æ ‡ï¼Œå…¶å…·ä½“å«ä¹‰ä¸º<strong>åœ¨ç»Ÿè®¡å‘¨æœŸï¼ˆå‘¨&#x2F;æœˆï¼‰å†…ï¼Œæ¯æ—¥æ´»è·ƒç”¨æˆ·æ•°åœ¨ç¬¬Næ—¥ä»å¯åŠ¨è¯¥Appçš„ç”¨æˆ·æ•°å æ¯”çš„å¹³å‡å€¼</strong>ã€‚å…¶ä¸­Né€šå¸¸å–2ã€3ã€7ã€<strong>14</strong>ã€30ï¼Œåˆ†åˆ«å¯¹åº”æ¬¡æ—¥ç•™å­˜ç‡ã€ä¸‰æ—¥ç•™å­˜ç‡ã€å‘¨ç•™å­˜ç‡ã€åŠæœˆç•™å­˜ç‡å’Œæœˆç•™å­˜ç‡ã€‚</p><p>ç•™å­˜ç‡å¸¸ç”¨äºåæ˜ ç”¨æˆ·ç²˜æ€§ï¼Œ<strong>å½“Nå–å€¼è¶Šå¤§ã€ç•™å­˜ç‡è¶Šé«˜æ—¶ï¼Œç”¨æˆ·ç²˜æ€§è¶Šé«˜</strong>ã€‚</p><h2 id="äºŒã€ç•™å­˜ç‡çš„è®¡ç®—"><a href="#äºŒã€ç•™å­˜ç‡çš„è®¡ç®—" class="headerlink" title="äºŒã€ç•™å­˜ç‡çš„è®¡ç®—"></a>äºŒã€ç•™å­˜ç‡çš„è®¡ç®—</h2><ul><li><p><strong>ç•™å­˜ç‡ &#x3D; ç™»é™†ç”¨æˆ·æ•°&#x2F;æ–°å¢ç”¨æˆ·æ•° * 100%</strong></p></li><li><p>æ–°å¢ç”¨æˆ·æ•°ï¼šåœ¨å½“å‰æ—¶é—´æ®µæ–°æ³¨å†Œï¼ˆæˆ–æ–°è®¿é—®ï¼‰çš„ç”¨æˆ·æ•°ï¼›</p></li><li><p>ç™»å½•ç”¨æˆ·æ•°ï¼šåœ¨ç»Ÿè®¡çš„æ—¶é—´æ®µè‡³å°‘ç™»å½•è¿‡ä¸€æ¬¡çš„ç”¨æˆ·æ•°ï¼›</p></li><li><p>æ¬¡æ—¥ç•™å­˜ç‡ï¼šåœ¨æ¬¡æ—¥è‡³å°‘ç™»å½•è¿‡ä¸€æ¬¡çš„ç”¨æˆ·æ•°&#x2F;å½“å¤©æ–°å¢çš„ç”¨æˆ·æ•°ï¼›</p></li><li><p>â—ï¸<strong>3æ—¥ç•™å­˜ç‡</strong>ï¼šåœ¨å¾€å3å¤©å†…<strong>è‡³å°‘ç™»å½•è¿‡ä¸€æ¬¡</strong>çš„ç”¨æˆ·æ•°&#x2F;å½“å¤©æ–°å¢çš„ç”¨æˆ·æ•°ï¼›</p></li><li><p>â—ï¸<strong>7æ—¥ç•™å­˜ç‡</strong>ï¼šåœ¨å¾€å7å¤©å†…<strong>è‡³å°‘ç™»å½•è¿‡ä¸€æ¬¡</strong>çš„ç”¨æˆ·æ•°&#x2F;å½“å¤©æ–°å¢çš„ç”¨æˆ·æ•°ï¼›</p></li><li><p>â—ï¸<strong>15æ—¥ç•™å­˜æ•°</strong>ï¼šå½“å¤©æ–°å¢çš„ç”¨æˆ·æ•°ï¼Œåœ¨å¾€å<strong>7å¤©å†…è‡³å°‘ç™»å½•è¿‡ä¸€æ¬¡</strong>çš„ç”¨æˆ·ï¼Œåœ¨å¾€å<strong>ç¬¬8å¤©åˆ°ç¬¬14å¤©å†…è‡³å°‘å†ç™»é™†è¿‡ä¸€æ¬¡</strong>çš„ç”¨æˆ·æ•°</p><p><strong>â¡ï¸ 3æ—¥å’Œ7æ—¥ï¼Œè‡³å°‘ç™»é™†è¿‡ä¸€æ¬¡ï¼›15æ—¥ï¼Œ7å¤©ä¸ºä¸€æ®µï¼Œåœ¨æ¯æ®µå†…è‡³å°‘ç™»å½•ä¸€æ¬¡ï¼</strong></p></li></ul><h2 id="SQLä¸­è®¡ç®—ç”¨æˆ·çš„ç•™å­˜ç‡"><a href="#SQLä¸­è®¡ç®—ç”¨æˆ·çš„ç•™å­˜ç‡" class="headerlink" title="SQLä¸­è®¡ç®—ç”¨æˆ·çš„ç•™å­˜ç‡"></a>SQLä¸­è®¡ç®—ç”¨æˆ·çš„ç•™å­˜ç‡</h2><ul><li><strong>æ–°å¢ç”¨æˆ·æ•°</strong></li></ul><p>ç”±äºæ•°æ®è¿‡å¤§ï¼Œè¿™æˆªå–æ—¶é—´2017.11.26~2017.12.03ä¸ºä¾‹ã€‚</p><p>é¦–å…ˆè®¡ç®—åˆ†æ¯ï¼Œè¿™é‡Œæœ‰çš„ç®—æ³•æ˜¯ç”¨æ–°å¢ç”¨æˆ·æ•°ï¼Œæœ‰çš„ç®—æ³•æ˜¯ç”¨æ´»è·ƒç”¨æˆ·æ•°ã€‚</p><p>âš ï¸æ³¨æ„ï¼š<strong>æ–°å¢ç”¨æˆ·æ•°ä¸æ´»è·ƒç”¨æˆ·æ•°å¹¶ä¸ç›¸ç­‰</strong>ï¼Œæ´»è·ƒç”¨æˆ·æ•°åŒ…å«æ–°å¢ç”¨æˆ·æ•°ã€‚æ´»è·ƒç”¨æˆ·æ•°ï¼Œå½“å¤©çš„è®¿é—®äººæ•°ï¼Œä¹Ÿå°±æ˜¯<strong>UV</strong>ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æ¯ä½ç”¨æˆ·çš„æœ€æ—©ç™»å½•æ—¥æœŸ</span></span><br><span class="line"><span class="keyword">SELECT</span> ç”¨æˆ·ID, <span class="built_in">MIN</span>(æ—¥æœŸ) <span class="keyword">AS</span> æœ€æ—©ç™»å½•æ—¥æœŸ</span><br><span class="line"><span class="keyword">FROM</span> userbehavior</span><br><span class="line"><span class="keyword">WHERE</span> æ—¥æœŸ <span class="operator">&gt;</span> <span class="string">&#x27;2017-11-25&#x27;</span><span class="keyword">AND</span> æ—¥æœŸ <span class="operator">&lt;</span> <span class="string">&#x27;2017-12-04&#x27;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> ç”¨æˆ·ID</span><br></pre></td></tr></table></figure><p><img                       lazyload                     alt="image"                     data-src="https://pic4.zhimg.com/80/v2-18cfc6382ff6f91e85948644b0e97137_1440w.webp"                      alt="img"                ></p><p>å†ä»ä¸Šè¡¨ä¸­è®¡ç®—å‡ºæ¯å¤©çš„æ–°å¢äººæ•°ï¼Œ<strong>â—ï¸ç®—æ–°å¢äººæ•°ç”¨çš„æ—¥æœŸæ˜¯æœ€æ—©ç™»å½•æ—¥æœŸï¼</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> æœ€æ—©ç™»å½•æ—¥æœŸ <span class="keyword">AS</span> æ—¥æœŸ, <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> ç”¨æˆ·ID) <span class="keyword">AS</span> æ–°å¢äººæ•°</span><br><span class="line"><span class="keyword">FROM</span>(<span class="keyword">SELECT</span> ç”¨æˆ·ID, <span class="built_in">MIN</span>(æ—¥æœŸ) <span class="keyword">AS</span> æœ€æ—©ç™»å½•æ—¥æœŸ</span><br><span class="line">     <span class="keyword">FROM</span> userbehavior</span><br><span class="line">     <span class="keyword">WHERE</span> æ—¥æœŸ <span class="operator">&gt;</span> <span class="string">&#x27;2017-11-25&#x27;</span> <span class="keyword">AND</span> æ—¥æœŸ <span class="operator">&lt;</span> <span class="string">&#x27;2017-12-04&#x27;</span></span><br><span class="line">     <span class="keyword">GROUP</span> <span class="keyword">BY</span> ç”¨æˆ·ID) <span class="keyword">AS</span> f</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> æœ€æ—©ç™»å½•æ—¥æœŸ</span><br></pre></td></tr></table></figure><p><img                       lazyload                     alt="image"                     data-src="https://pic4.zhimg.com/80/v2-967700ed583d369a6686170d50030ec3_1440w.webp"                      alt="img"                ></p><p>ä»¥ä¸‹æ˜¯æ´»è·ƒç”¨æˆ·æ•°çš„ç®—æ³•ï¼ŒäºŒè€…ç¡®å®æ•°å€¼ä¸Šå¹¶ä¸ç›¸ç­‰ã€‚<strong>â—ï¸ç®—æ¯æ—¥æ´»è·ƒç”¨æˆ·æ•°ç”¨çš„æ—¥æœŸå°±æ˜¯å½“å¤©çš„æ—¥æœŸï¼</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æ¯å¤©æ´»è·ƒç”¨æˆ·æ•°=UV è®¿å®¢æ•°</span></span><br><span class="line"><span class="keyword">SELECT</span> æ—¥æœŸ, <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> ç”¨æˆ·ID) <span class="keyword">AS</span> æ´»è·ƒç”¨æˆ·æ•°</span><br><span class="line"><span class="keyword">FROM</span> userbehavior</span><br><span class="line"><span class="keyword">where</span> æ—¥æœŸ <span class="operator">&gt;</span><span class="string">&#x27;2017-11-25&#x27;</span> <span class="keyword">AND</span> æ—¥æœŸ <span class="operator">&lt;</span> <span class="string">&#x27;2017-12-04&#x27;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> æ—¥æœŸ</span><br></pre></td></tr></table></figure><p><img                       lazyload                     alt="image"                     data-src="https://pic1.zhimg.com/80/v2-5466468851b1d4b0794d8ec92c6f43f0_1440w.webp"                      alt="img"                ></p><p>æŠ½å–7å¤©çš„æ´»è·ƒç”¨æˆ·æ•°ã€‚</p><ul><li><strong>æ¬¡æ—¥ç•™å­˜çš„ç”¨æˆ·æ•°</strong></li></ul><ol><li>æ¬¡æ—¥çš„æ—¶é—´é—´éš”ä¸º1ï¼Œæ¶‰åŠåˆ°æ—¶é—´é—´éš”é‡‡ç”¨è‡ªè”ç»“ã€‚</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.ç”¨æˆ·ID, a.`æ—¥æœŸ` <span class="keyword">AS</span> atime, b.`æ—¥æœŸ` <span class="keyword">AS</span> btime</span><br><span class="line"><span class="keyword">FROM</span> userbehavior <span class="keyword">AS</span> a </span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> userbehavior <span class="keyword">AS</span> b</span><br><span class="line"><span class="keyword">ON</span> a.`ç”¨æˆ·ID` <span class="operator">=</span> b.`ç”¨æˆ·ID`</span><br><span class="line"><span class="keyword">WHERE</span> a.`æ—¥æœŸ` <span class="operator">&gt;</span> <span class="string">&#x27;2017-11-25&#x27;</span> <span class="keyword">AND</span> a.`æ—¥æœŸ` <span class="operator">&lt;</span> <span class="string">&#x27;2017-12-04&#x27;</span></span><br></pre></td></tr></table></figure><p><img                       lazyload                     alt="image"                     data-src="https://pic3.zhimg.com/80/v2-58aa55bd327431b0782ff0dc5d41c8ce_1440w.webp"                      alt="img"                ></p><p>å°†ä¸Šè¡¨å­˜ä¸ºè§†å›¾Cï¼Œ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> C(ç”¨æˆ·ID, atime, btime)</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> a.ç”¨æˆ·ID, a.`æ—¥æœŸ`, b.`æ—¥æœŸ` </span><br><span class="line"><span class="keyword">from</span> userbehavior <span class="keyword">AS</span> a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> userbehavior <span class="keyword">AS</span> b</span><br><span class="line"><span class="keyword">ON</span> a.`ç”¨æˆ·ID`<span class="operator">=</span>b.`ç”¨æˆ·ID`</span><br><span class="line"><span class="keyword">WHERE</span> a.`æ—¥æœŸ`<span class="operator">&gt;</span><span class="string">&#x27;2017-11-25&#x27;</span><span class="keyword">AND</span> a.`æ—¥æœŸ` <span class="operator">&lt;</span> <span class="string">&#x27;2017-12-04&#x27;</span>;</span><br></pre></td></tr></table></figure><ol start="2"><li>è®¡ç®—æ—¶é—´é—´éš”ç”¨<a class="link"   href="https://blog.csdn.net/qq_37493556/article/details/92805912" >timestampdiffå‡½æ•°<i class="fas fa-external-link-alt"></i></a></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> `ç”¨æˆ·ID`, TIMESTAMPDIFF(<span class="keyword">DAY</span>, atime, btime)<span class="keyword">AS</span> æ—¶é—´é—´éš”</span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">  <span class="keyword">SELECT</span> a.ç”¨æˆ·ID, a.æ—¥æœŸ <span class="keyword">as</span> atime, b.æ—¥æœŸ <span class="keyword">as</span> btime</span><br><span class="line">  <span class="keyword">FROM</span> userbehavior <span class="keyword">as</span> a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> userbehavior <span class="keyword">as</span> b</span><br><span class="line">  <span class="keyword">ON</span> a.ç”¨æˆ·ID<span class="operator">=</span>b.`ç”¨æˆ·ID`</span><br><span class="line">  <span class="keyword">WHERE</span> a.`æ—¥æœŸ`<span class="operator">&gt;</span><span class="string">&#x27;2017-11-25&#x27;</span><span class="keyword">AND</span> a.`æ—¥æœŸ` <span class="operator">&lt;</span> <span class="string">&#x27;2017-12-04&#x27;</span>) <span class="keyword">AS</span> c</span><br><span class="line"><span class="comment">-- è¿™é‡Œç›´æ¥è®¾ç½®ä¸ºè¡¨c</span></span><br></pre></td></tr></table></figure><p><img                       lazyload                     alt="image"                     data-src="https://pic2.zhimg.com/80/v2-6d0f637e1aabdc3bcc2b57dedff5094d_1440w.webp"                      alt="img"                ></p><p>å¾—åˆ°äº†ç”¨æˆ·çš„æ—¶é—´é—´éš”</p><p>3.ç”¨caseè¯­å¥ç­›é€‰å‡ºæ—¶é—´é—´éš”ä¸º1çš„æ•°æ®ï¼Œå¹¶ä¸”è¿›è¡Œè®¡æ•°</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span>, <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">case</span> <span class="keyword">when</span> æ—¶é—´é—´éš” <span class="operator">=</span> <span class="number">1</span> <span class="keyword">then</span> `ç”¨æˆ·ID`</span><br><span class="line"><span class="keyword">ELSE</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">END</span>)<span class="keyword">AS</span> æ¬¡æ—¥ç•™å­˜æ•°</span><br><span class="line"><span class="keyword">FROM</span>( <span class="keyword">SELECT</span> `ç”¨æˆ·ID`,TIMESTAMPDIFF(<span class="keyword">DAY</span>,atime,btime)<span class="keyword">AS</span> æ—¶é—´é—´éš”</span><br><span class="line"> <span class="keyword">FROM</span> (</span><br><span class="line"><span class="keyword">SELECT</span> a.ç”¨æˆ·ID,a.æ—¥æœŸ <span class="keyword">as</span> atime,b.æ—¥æœŸ <span class="keyword">as</span> btime</span><br><span class="line"><span class="keyword">FROM</span> userbehavior <span class="keyword">as</span> a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> userbehavior <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">ON</span> a.ç”¨æˆ·ID<span class="operator">=</span>b.`ç”¨æˆ·ID`</span><br><span class="line"><span class="keyword">WHERE</span> a.`æ—¥æœŸ`<span class="operator">&gt;</span><span class="string">&#x27;2017-11-25&#x27;</span><span class="keyword">AND</span> a.`æ—¥æœŸ` <span class="operator">&lt;</span> <span class="string">&#x27;2017-12-04&#x27;</span></span><br><span class="line">) <span class="keyword">AS</span> c</span><br><span class="line">)<span class="keyword">AS</span> d</span><br></pre></td></tr></table></figure><ul><li><strong>æ¬¡æ—¥ç•™å­˜ç‡</strong></li></ul><p>æ¬¡æ—¥ç•™å­˜ç‡&#x3D;æ¬¡æ—¥ç•™å­˜ç”¨æˆ·æ•°&#x2F;å½“æ—¥æ´»è·ƒç”¨æˆ·æ•°</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span>,<span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">case</span> <span class="keyword">when</span> æ—¶é—´é—´éš” <span class="operator">=</span> <span class="number">1</span> <span class="keyword">then</span> `ç”¨æˆ·ID`</span><br><span class="line"><span class="keyword">ELSE</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">END</span>) <span class="keyword">AS</span> æ¬¡æ—¥ç•™å­˜æ•°<span class="operator">/</span><span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> ç”¨æˆ·ID) <span class="keyword">AS</span> æ¬¡æ—¥ç•™å­˜ç‡</span><br><span class="line"><span class="keyword">FROM</span>( <span class="keyword">SELECT</span> `ç”¨æˆ·ID`,TIMESTAMPDIFF(<span class="keyword">DAY</span>,atime,btime)<span class="keyword">AS</span> æ—¶é—´é—´éš”</span><br><span class="line"> <span class="keyword">FROM</span> (</span><br><span class="line"><span class="keyword">SELECT</span> a.ç”¨æˆ·ID,a.æ—¥æœŸ <span class="keyword">as</span> atime,b.æ—¥æœŸ <span class="keyword">as</span> btime</span><br><span class="line"><span class="keyword">FROM</span> userbehavior <span class="keyword">as</span> a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> userbehavior <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">ON</span> a.ç”¨æˆ·ID<span class="operator">=</span>b.`ç”¨æˆ·ID`</span><br><span class="line"><span class="keyword">WHERE</span> a.`æ—¥æœŸ`<span class="operator">&gt;</span><span class="string">&#x27;2017-11-25&#x27;</span><span class="keyword">AND</span> a.`æ—¥æœŸ` <span class="operator">&lt;</span> <span class="string">&#x27;2017-12-04&#x27;</span></span><br><span class="line">) <span class="keyword">AS</span> c</span><br><span class="line">)<span class="keyword">AS</span> d</span><br></pre></td></tr></table></figure><h2 id="ä¸‰ã€ä¸‰æ—¥ä»¥åŠNæ—¥ç•™å­˜çš„è®¡ç®—"><a href="#ä¸‰ã€ä¸‰æ—¥ä»¥åŠNæ—¥ç•™å­˜çš„è®¡ç®—" class="headerlink" title="ä¸‰ã€ä¸‰æ—¥ä»¥åŠNæ—¥ç•™å­˜çš„è®¡ç®—"></a>ä¸‰ã€ä¸‰æ—¥ä»¥åŠNæ—¥ç•™å­˜çš„è®¡ç®—</h2><p>åªéœ€è¦ä¿®æ”¹æ—¶é—´é—´éš”&#x3D;Nå³å¯ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> æ—¥æœŸ,<span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> ç”¨æˆ·ID <span class="keyword">AS</span> æ´»è·ƒç”¨æˆ·æ•°,</span><br><span class="line"><span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">case</span> <span class="keyword">when</span> æ—¶é—´é—´éš”<span class="operator">=</span><span class="number">1</span> <span class="keyword">then</span> `ç”¨æˆ·ID`</span><br><span class="line"><span class="keyword">ELSE</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">END</span>) <span class="keyword">AS</span> æ¬¡æ—¥ç•™å­˜æ•°<span class="operator">/</span><span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> ç”¨æˆ·ID) <span class="keyword">AS</span> æ¬¡æ—¥ç•™å­˜ç‡</span><br><span class="line"><span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">case</span> <span class="keyword">when</span> æ—¶é—´é—´éš”<span class="operator">=</span><span class="number">3</span> <span class="keyword">then</span> `ç”¨æˆ·ID`</span><br><span class="line"><span class="keyword">ELSE</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">END</span>) <span class="keyword">AS</span> æ¬¡æ—¥ç•™å­˜æ•°<span class="operator">/</span><span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> ç”¨æˆ·ID) <span class="keyword">AS</span> ä¸‰æ—¥ç•™å­˜ç‡</span><br><span class="line"><span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">case</span> <span class="keyword">when</span> æ—¶é—´é—´éš”<span class="operator">=</span><span class="number">7</span> <span class="keyword">then</span> `ç”¨æˆ·ID`</span><br><span class="line"><span class="keyword">ELSE</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">END</span>) <span class="keyword">AS</span> æ¬¡æ—¥ç•™å­˜æ•°<span class="operator">/</span><span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> ç”¨æˆ·ID) <span class="keyword">AS</span> ä¸ƒæ—¥ç•™å­˜ç‡</span><br><span class="line"><span class="keyword">FROM</span>( <span class="keyword">SELECT</span> `ç”¨æˆ·ID`,TIMESTAMPDIFF(<span class="keyword">DAY</span>,atime,btime)<span class="keyword">AS</span> æ—¶é—´é—´éš”</span><br><span class="line"> <span class="keyword">FROM</span> (</span><br><span class="line"><span class="keyword">SELECT</span> a.ç”¨æˆ·ID,a.æ—¥æœŸ <span class="keyword">as</span> atime,b.æ—¥æœŸ <span class="keyword">as</span> btime</span><br><span class="line"><span class="keyword">FROM</span> userbehavior <span class="keyword">as</span> a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> æ¯æ—¥æ–°å¢ç”¨æˆ·æ•°è¡¨ <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">ON</span> a.ç”¨æˆ·ID<span class="operator">=</span>b.`ç”¨æˆ·ID`</span><br><span class="line"><span class="keyword">WHERE</span> a.`æ—¥æœŸ`<span class="operator">&gt;</span><span class="string">&#x27;2017-11-25&#x27;</span><span class="keyword">AND</span> a.`æ—¥æœŸ` <span class="operator">&lt;</span> <span class="string">&#x27;2017-12-04&#x27;</span></span><br><span class="line">) <span class="keyword">AS</span> c</span><br><span class="line">)<span class="keyword">AS</span> d</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è®¡ç®—ç”¨æˆ·æ¬¡æ—¥ç•™å­˜ç‡&quot;&gt;&lt;a href=&quot;#è®¡ç®—ç”¨æˆ·æ¬¡æ—¥ç•™å­˜ç‡&quot; class=&quot;headerlink&quot; title=&quot;è®¡ç®—ç”¨æˆ·æ¬¡æ—¥ç•™å­˜ç‡&quot;&gt;&lt;/a&gt;è®¡ç®—ç”¨æˆ·æ¬¡æ—¥ç•™å­˜ç‡&lt;/h1&gt;&lt;p&gt;å¦‚æœåªæ˜¯è®¡ç®—ç”¨æˆ·çš„&lt;strong&gt;æ¬¡æ—¥&lt;/strong&gt;ç•™å­˜ç‡ï¼Œé‚£ä¹ˆä½¿ç”¨date_s</summary>
      
    
    
    
    <category term="Programming" scheme="https://artemis727.github.io/categories/Programming/"/>
    
    <category term="SQL" scheme="https://artemis727.github.io/categories/Programming/SQL/"/>
    
    
    <category term="SQL" scheme="https://artemis727.github.io/tags/SQL/"/>
    
  </entry>
  
</feed>
